<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Stream 2 Night</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <style>
    body { background: linear-gradient(to bottom, #1b103f, #090d28); }
    .wildcards-overlay {
      position: fixed; z-index: 200; inset: 0; background: rgba(20,12,40,0.98);
      display: flex; align-items: center; justify-content: center;
      animation: fadeIn 0.3s;
    }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    .wildcards-close-btn {
      position: absolute; top: 28px; right: 38px; z-index: 3;
      background: #1b103f; color: #ffe178; border: 2.5px solid #ffde57;
      border-radius: 9999px; width: 55px; height: 55px;
      font-size: 2.1rem; font-weight: 700;
      box-shadow: 0 2px 14px #ffe17844;
      cursor: pointer; outline: none; transition: background 0.13s;
      display: flex; align-items: center; justify-content: center;
    }
    .wildcards-close-btn:hover { background: #2cb67d; color: #fff; }
    .wildcards-deck {
      display: flex;
      justify-content: center;
      align-items: flex-end;
      gap: 2vw;
      min-height: 300px;
    }
    .wildcards-card {
      width: 140px; height: 210px;
      border-radius: 16px;
      background: #1b103f;
      box-shadow: 0 8px 36px 0 #0008, 0 1px 2px 2px #e4d49c44 inset;
      border: 3px solid #ffde57;
      outline: 2px solid #f4e5b1;
      outline-offset: -5px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      color: #fff;
      font-size: 1.1rem;
      font-weight: 700;
      position: relative;
      transition: transform 0.33s cubic-bezier(.7,1.8,.2,1), box-shadow 0.22s;
      cursor: pointer;
      user-select: none;
      overflow: hidden;
      background-clip: padding-box;
    }
    .wildcards-card.selected {
      transform: scale(1.08) translateY(-18px);
      z-index: 10;
      box-shadow: 0 6px 30px #ffde573c, 0 1px 8px #fff3;
      border-color: #7f5af0;
    }
    .wildcards-card img {
      width: 98px; height: 146px; border-radius: 11px; box-shadow: 0 2px 8px #0007;
      object-fit: cover; background: #241a36;
      margin: 15px 0 8px 0;
    }
    .wildcards-card .wc-title {
      font-size: 1.03rem;
      font-weight: 700;
      color: #ffe178;
      margin-bottom: 0.2rem;
      text-align: center;
      padding: 0 0.4rem;
      line-height: 1.18;
    }
    .wildcards-card .wc-type {
      font-size: 0.93rem;
      font-weight: 400;
      color: #7f5af0;
      margin-bottom: 0.2rem;
      text-align: center;
    }
    .wildcards-card .wc-provider-logos {
      display: flex; flex-wrap: wrap; gap: 2px;
      justify-content: center;
      margin-top: 0.08rem;
      margin-bottom: 0.35rem;
    }
    .wildcards-actions {
      display: flex; justify-content: center; gap: 2.5rem; align-items: center;
      margin-top: 1.4rem;
    }
    .wildcards-swipe-btn {
      background: linear-gradient(90deg,#7f5af0 0,#2cb67d 80%);
      color: #fff; border-radius: 9999px; padding: 0.59rem 1.5rem;
      font-weight: 700; font-size: 1.25rem; box-shadow: 0 2px 14px #7f5af044;
      margin: 0 1.2rem; border: none; cursor: pointer; outline: none;
      transition: background 0.14s, color 0.14s;
    }
    .wildcards-swipe-btn.reject {
      background: linear-gradient(90deg,#fc7e1e 0,#ffde57 80%);
      color: #522; box-shadow: 0 2px 14px #ffde5744;
    }
    .wildcards-hand-cards {
      display: flex; justify-content: center; align-items: flex-end;
      gap: 2vw; margin-top: 1.2rem; min-height: 220px;
      width: 98vw; max-width: 900px; flex-wrap: wrap;
    }
    .wildcards-celebration {
      position: absolute; inset: 0; pointer-events: none; z-index: 20;
      overflow: hidden;
    }
    .confetti-piece {
      position: absolute;
      width: 18px; height: 10px;
      border-radius: 4px;
      opacity: 0.85;
      animation: confetti-fall 1.8s cubic-bezier(.1,.8,.3,1) forwards;
    }
    @keyframes confetti-fall {
      0% { transform: translateY(-45vh) rotateZ(0deg) scale(1.2);}
      80% { opacity: 1;}
      100% { transform: translateY(95vh) rotateZ(360deg) scale(1);}
    }
  </style>
</head>
<body class="text-white">
  <section class="text-center py-20 px-6">
    <h1 class="text-6xl font-bold mb-4 leading-tight bg-gradient-to-r from-purple-500 via-pink-500 to-red-500 bg-clip-text text-transparent">Stream 2 Night</h1>
    <p class="text-xl text-gray-300 mb-6">Smarter streaming, simplified.</p>
    <div class="mb-6 flex justify-center gap-3">
      <button id="regionUK" class="flag-tab selected" title="United Kingdom" aria-label="United Kingdom">
        <img src="https://hatscripts.github.io/circle-flags/flags/gb.svg" alt="UK" class="flag-img" />
      </button>
      <button id="regionUS" class="flag-tab" title="United States" aria-label="United States">
        <img src="https://hatscripts.github.io/circle-flags/flags/us.svg" alt="US" class="flag-img" />
      </button>
      <button id="regionCA" class="flag-tab" title="Canada" aria-label="Canada">
        <img src="https://hatscripts.github.io/circle-flags/flags/ca.svg" alt="Canada" class="flag-img" />
      </button>
    </div>
    <div class="mb-8 flex justify-center gap-4">
      <button id="allTab" class="tab-button active-tab">All</button>
      <button id="movieTab" class="tab-button inactive-tab">Movies</button>
      <button id="tvTab" class="tab-button inactive-tab">Series</button>
    </div>
    <div class="flex justify-center items-center mb-8">
      <input id="searchInput" type="text" autocomplete="off" placeholder="Search for a movie or series..." class="text-black w-full max-w-md px-4 py-2 rounded" />
      <button id="wildBtn" class="wild-btn" title="Try the Wild Cards game!">üÉè Wild Cards</button>
    </div>
    <div id="searchResults" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4"></div>
    <button id="showMoreBtn" class="mt-6 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-6 rounded">Show More</button>
  </section>
  <img src="https://em-content.zobj.net/source/microsoft-teams/337/panda_1f43c.png" alt="Panda" class="fixed top-4 right-4 h-16 w-16 z-50">

  <footer class="text-center p-4 text-gray-400">
    This site uses the TMDb and Watchmode APIs but is not endorsed or certified by either.
  </footer>
  <!-- Wild Cards Overlay -->
  <div id="wildcardsOverlay" style="display:none;" class="wildcards-overlay">
    <button class="wildcards-close-btn" id="wildcardsCloseBtn" title="Close">√ó</button>
    <div id="wildcardsGameContainer" style="width:100%;height:100%;display:flex;justify-content:center;align-items:center;position:relative;flex-direction:column;">
      <!-- Wild Cards game will render here -->
    </div>
    <div id="wildcardsCelebration" class="wildcards-celebration"></div>
  </div>
  <script>
    // --- Existing setup (API keys, helpers, search, etc) ---
    const tmdbApiKey = '2acda6d77609c7c9b6bce9bdf4e5271f';
    const watchmodeApiKey = 'Obbabfda4fmsh11a51996ff09aeap16c8a6jsn6ee377acda63';
    let currentType = 'all';
    let currentRegion = 'GB';
    let currentQuery = '';
    let currentPage = 1;
    let results = [];
    let isLoading = false;
    let maxShowMore = 4;
    let showMoreCount = 0;
    let mediaCache = {};

    function getEndpoint(type, query, page) {
      let base = 'https://api.themoviedb.org/3';
      if (query) {
        if (type === 'movie') return `${base}/search/movie?api_key=${tmdbApiKey}&language=en-${currentRegion}&query=${encodeURIComponent(query)}&page=${page}`;
        if (type === 'tv') return `${base}/search/tv?api_key=${tmdbApiKey}&language=en-${currentRegion}&query=${encodeURIComponent(query)}&page=${page}`;
        return `${base}/search/multi?api_key=${tmdbApiKey}&language=en-${currentRegion}&query=${encodeURIComponent(query)}&page=${page}`;
      } else {
        if (type === 'movie') return `${base}/movie/popular?api_key=${tmdbApiKey}&language=en-${currentRegion}&page=${page}`;
        if (type === 'tv') return `${base}/tv/popular?api_key=${tmdbApiKey}&language=en-${currentRegion}&page=${page}`;
        return [
          `${base}/movie/popular?api_key=${tmdbApiKey}&language=en-${currentRegion}&page=${page}`,
          `${base}/tv/popular?api_key=${tmdbApiKey}&language=en-${currentRegion}&page=${page}`
        ];
      }
    }

    async function fetchMedia(type, query, page) {
      if (mediaCache[type + '|' + query + '|' + page + '|' + currentRegion]) return mediaCache[type + '|' + query + '|' + page + '|' + currentRegion];
      let res, data, arr = [];
      let endpoints = getEndpoint(type, query, page);
      if (Array.isArray(endpoints)) {
        for (let ep of endpoints) {
          res = await fetch(ep);
          data = await res.json();
          arr = arr.concat((data.results || []).map(item => {
            if (ep.includes('/tv/')) item.media_type = 'tv';
            else item.media_type = 'movie';
            return item;
          }));
        }
      } else {
        res = await fetch(endpoints);
        data = await res.json();
        arr = (data.results || []).map(item => {
          if (!item.media_type) item.media_type = type === 'all' ? (item.title ? 'movie' : 'tv') : type;
          return item;
        });
      }
      mediaCache[type + '|' + query + '|' + page + '|' + currentRegion] = arr;
      return arr;
    }

    function deduplicateAndSort(arr, query) {
      const norm = s => (s || '').toLowerCase().replace(/^the\s+/i, '');
      const seen = new Set();
      const queryNorm = norm(query);
      let filtered = arr.filter(item => {
        let idKey = (item.media_type || '') + ':' + item.id;
        if (seen.has(idKey)) return false;
        seen.add(idKey);
        if (!query && (item.vote_count || 0) < 100) return false;
        if (currentType !== 'all' && item.media_type !== currentType) return false;
        return true;
      });
      return filtered.sort((a, b) => {
        let aT = norm(a.title || a.name || ''), bT = norm(b.title || b.name || '');
        let aExact = aT === queryNorm, bExact = bT === queryNorm;
        if (aExact && !bExact) return -1; if (!aExact && bExact) return 1;
        let aStarts = aT.startsWith(queryNorm), bStarts = bT.startsWith(queryNorm);
        if (aStarts && !bStarts) return -1; if (!aStarts && bStarts) return 1;
        if ((b.vote_count || 0) !== (a.vote_count || 0)) return (b.vote_count || 0) - (a.vote_count || 0);
        return (b.popularity || 0) - (a.popularity || 0);
      });
    }

    async function fetchAvailability(id, mediaType, title) {
      const type = mediaType === 'tv' ? 'tv' : 'movie';
      try {
        const tmdbRes = await fetch(`https://api.themoviedb.org/3/${type}/${id}/watch/providers?api_key=${tmdbApiKey}`);
        const tmdbData = await tmdbRes.json();
        const countryData = tmdbData.results?.[currentRegion];
        let stream = '', buy = '';
        if (countryData) {
          const render = (items) => items.map(p => `<img src='https://image.tmdb.org/t/p/w45${p.logo_path}' alt='${p.provider_name}' title='${p.provider_name}' class='inline-block h-8 mx-2'>`).join('');
          stream = countryData.flatrate ? render(countryData.flatrate) : '';
          buy = countryData.buy ? render(countryData.buy) : '';
        }
        if (!stream && !buy && title) {
          const searchRes = await fetch(`https://watchmode.p.rapidapi.com/search/?search_value=${encodeURIComponent(title)}&search_type=1`, {
            method: 'GET',
            headers: {
              'X-RapidAPI-Key': watchmodeApiKey,
              'X-RapidAPI-Host': 'watchmode.p.rapidapi.com'
            }
          });
          const searchData = await searchRes.json();
          const match = searchData.title_results?.find(r => r.name.toLowerCase() === title.toLowerCase());
          if (match) {
            const sourceRes = await fetch(`https://watchmode.p.rapidapi.com/title/${match.id}/sources/`, {
              method: 'GET',
              headers: {
                'X-RapidAPI-Key': watchmodeApiKey,
                'X-RapidAPI-Host': 'watchmode.p.rapidapi.com'
              }
            });
            const sourceData = await sourceRes.json();
            const watchmodeLogos = sourceData.filter(s => s.type === 'sub' || s.type === 'buy')
              .map(s => `<div class='text-sm text-white border px-2 py-1 rounded mx-1'>${s.name}</div>`)
              .join('');
            stream = watchmodeLogos;
          }
        }
        if (!stream && !buy) return null;
        return { stream, buy };
      } catch (err) {
        return null;
      }
    }

    // --- WILD CARDS GAME LOGIC ---
    let wildcardsDeck = [];
    let wildcardsHand = [];
    let wildcardsPhase = 'deck';
    let wildcardsCurrent = 0;
    let wildcardsOverlayOpen = false;

    function runCelebration() {
      const colors = ['#ffe178', '#fc7e1e', '#7f5af0', '#2cb67d', '#fff', '#ffde57'];
      const area = document.getElementById('wildcardsCelebration');
      area.innerHTML = '';
      for (let i = 0; i < 45; i++) {
        const piece = document.createElement('div');
        piece.className = 'confetti-piece';
        piece.style.left = (Math.random() * 100) + 'vw';
        piece.style.top = (Math.random() * 10) + 'vh';
        piece.style.background = colors[Math.floor(Math.random() * colors.length)];
        piece.style.transform = `rotateZ(${Math.random()*360}deg)`;
        piece.style.animationDelay = (Math.random() * 0.5) + 's';
        area.appendChild(piece);
      }
      setTimeout(() => { area.innerHTML = ''; }, 2100);
    }

    // Render the deck of cards (first round)
    function renderWildcardsDeck() {
      wildcardsPhase = 'deck';
      const cont = document.getElementById('wildcardsGameContainer');
      cont.innerHTML = `<div class="text-2xl font-bold text-yellow-100 mb-8">Your Wild Cards</div>`;
      let cardsHTML = `<div class="wildcards-deck">`;
      for (let i = 0; i < wildcardsDeck.length; i++) {
        const card = wildcardsDeck[i];
        cardsHTML += `
          <div class="wildcards-card${i === wildcardsCurrent ? ' selected' : ''}" data-idx="${i}">
            <img src="${card.poster_path ? `https://image.tmdb.org/t/p/w500${card.poster_path}` : ''}" alt="">
            <div class="wc-title">${card.title || card.name || "Untitled"}</div>
            <div class="wc-type">${card.media_type==='tv'?'Series':'Movie'}</div>
            <div class="wc-provider-logos">${(card.availability && card.availability.stream) ? card.availability.stream : "<span style='color:#fff2'>No streaming info</span>"}</div>
          </div>`;
      }
      cardsHTML += `</div>`;
      cont.innerHTML += cardsHTML;

      // Actions for selected card
      cont.innerHTML += `
        <div class="wildcards-actions">
          <button class="wildcards-swipe-btn reject" id="wcRejectBtn">‚úó Reject</button>
          <button class="wildcards-swipe-btn" id="wcKeepBtn">‚úì Keep</button>
        </div>
        <div class="text-xs mt-2 text-gray-300 text-center">Click a card to select, then keep or reject. (Only one at a time)</div>
      `;

      // Card click logic
      setTimeout(()=>{
        cont.querySelectorAll('.wildcards-card').forEach(cardEl=>{
          cardEl.onclick = ()=>{
            let idx = +cardEl.getAttribute('data-idx');
            wildcardsCurrent = idx;
            renderWildcardsDeck();
          }
        });
        document.getElementById('wcKeepBtn').onclick = ()=>swipeWildcardsCard('keep');
        document.getElementById('wcRejectBtn').onclick = ()=>swipeWildcardsCard('reject');
      }, 10);
    }

    // After keep/reject, move deck forward or to hand phase
    function swipeWildcardsCard(action) {
      const idx = wildcardsCurrent;
      if(action === 'keep') wildcardsHand.push(wildcardsDeck[idx]);
      wildcardsDeck.splice(idx,1);
      if(wildcardsDeck.length === 0) {
        renderWildcardsHand();
      } else {
        wildcardsCurrent = Math.max(0, Math.min(wildcardsCurrent, wildcardsDeck.length-1));
        renderWildcardsDeck();
      }
    }

    // Hand phase
    function renderWildcardsHand() {
      wildcardsPhase = 'hand';
      const cont = document.getElementById('wildcardsGameContainer');
      cont.innerHTML = `<div class="text-xl text-yellow-100 mb-2 font-bold">Your Hand</div>`;
      if(wildcardsHand.length === 0) {
        cont.innerHTML += `<div class="text-lg text-pink-200 mb-5">You rejected all cards! <br>Try again?</div>
        <button class="wildcards-swipe-btn" id="wcRestartBtn" style="margin-top:2rem;">Play Again</button>`;
        document.getElementById('wcRestartBtn').onclick = ()=>startWildcardsGame();
        return;
      }
      let cardsHTML = `<div class="wildcards-hand-cards">`;
      for(let i=0;i<wildcardsHand.length;i++) {
        cardsHTML += `
          <div class="wildcards-card" data-idx="${i}">
            <img src="${wildcardsHand[i].poster_path ? `https://image.tmdb.org/t/p/w500${wildcardsHand[i].poster_path}` : ''}" alt="">
            <div class="wc-title">${wildcardsHand[i].title || wildcardsHand[i].name || "Untitled"}</div>
            <div class="wc-type">${wildcardsHand[i].media_type==='tv'?'Series':'Movie'}</div>
            <div class="wc-provider-logos">${(wildcardsHand[i].availability && wildcardsHand[i].availability.stream) ? wildcardsHand[i].availability.stream : "<span style='color:#fff2'>No streaming info</span>"}</div>
          </div>`;
      }
      cardsHTML += `</div>`;
      cont.innerHTML += cardsHTML;
      cont.innerHTML += `<div style="margin-top:1.5rem;text-align:center;">
        <div class="text-sm text-gray-300">Click a card to review, keep or remove. <br>Continue until one remains!</div>
      </div>`;
      setTimeout(()=>{
        cont.querySelectorAll('.wildcards-card').forEach(cardEl=>{
          cardEl.onclick = ()=>{
            let idx = +cardEl.getAttribute('data-idx');
            reviewHandCard(idx);
          }
        });
      },30);
    }

    // Review a card in hand, keep/remove
    function reviewHandCard(idx) {
      const cont = document.getElementById('wildcardsGameContainer');
      const card = wildcardsHand[idx];
      cont.innerHTML = `
        <div class="wildcards-card selected" style="margin:auto;">
          <img src="${card.poster_path ? `https://image.tmdb.org/t/p/w500${card.poster_path}` : ''}" alt="">
          <div class="wc-title">${card.title || card.name || "Untitled"}</div>
          <div class="wc-type">${card.media_type==='tv'?'Series':'Movie'}</div>
          <div class="wc-provider-logos">${(card.availability && card.availability.stream) ? card.availability.stream : "<span style='color:#fff2'>No streaming info</span>"}</div>
        </div>
        <div class="wildcards-actions">
          <button class="wildcards-swipe-btn reject" id="wcRemoveFromHandBtn">Remove</button>
          <button class="wildcards-swipe-btn" id="wcKeepInHandBtn">Keep</button>
        </div>
      `;
      document.getElementById('wcKeepInHandBtn').onclick = ()=>{
        if(wildcardsHand.length === 1) renderWildcardsFinal();
        else renderWildcardsHand();
      };
      document.getElementById('wcRemoveFromHandBtn').onclick = ()=>{
        wildcardsHand.splice(idx,1);
        if(wildcardsHand.length === 1) renderWildcardsFinal();
        else renderWildcardsHand();
      };
    }

    // Final - one card left
    function renderWildcardsFinal() {
      wildcardsPhase = 'final';
      const cont = document.getElementById('wildcardsGameContainer');
      const card = wildcardsHand[0];
      cont.innerHTML = `<div style="display:flex;flex-direction:column;align-items:center;">
        <div style="font-size:2.1rem;color:#ffe178;font-weight:800;margin-bottom:1.3rem;text-shadow:0 1px 8px #7f5af044,0 0 18px #fff3;">Your Pick!</div>
        <div class="wildcards-card selected" style="margin:auto;">
          <img src="${card.poster_path ? `https://image.tmdb.org/t/p/w500${card.poster_path}` : ''}" alt="">
          <div class="wc-title">${card.title || card.name || "Untitled"}</div>
          <div class="wc-type">${card.media_type==='tv'?'Series':'Movie'}</div>
          <div class="wc-provider-logos">${(card.availability && card.availability.stream) ? card.availability.stream : "<span style='color:#fff2'>No streaming info</span>"}</div>
        </div>
        <div style="font-size:1.4rem;color:#ffde57;margin-top:1.7rem;text-align:center;">
        Enjoy your <span style="color:#7f5af0">${card.media_type==='tv'?'Series':'Movie'}</span> night!
        </div>
      </div>`;
      runCelebration();
    }

    // Start wild cards game: get random 5 cards with streaming
    async function startWildcardsGame() {
      document.getElementById('wildcardsOverlay').style.display = 'flex';
      document.body.style.overflow = 'hidden';
      wildcardsOverlayOpen = true;
      wildcardsDeck = [];
      wildcardsHand = [];
      wildcardsPhase = 'deck';
      wildcardsCurrent = 0;
      // Show loading spinner
      const cont = document.getElementById('wildcardsGameContainer');
      cont.innerHTML = `<div style="display:flex;flex-direction:column;align-items:center;">
        <div class="spin-wheel"></div>
        <div class="text-xl font-bold mt-2">Shuffling your deck‚Ä¶</div>
      </div>`;
      // Fetch 5 randoms with streaming
      let tries = 0;
      while(wildcardsDeck.length < 5 && tries < 15) {
        let randPage = 1 + Math.floor(Math.random() * 4);
        let media = await fetchMedia(currentType, '', randPage);
        media = deduplicateAndSort(media, '').filter(i => (i.vote_count || 0) >= 100);
        for (let i = media.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [media[i], media[j]] = [media[j], media[i]];
        }
        for (let m of media) {
          if(wildcardsDeck.length >= 5) break;
          const avail = await fetchAvailability(m.id, m.media_type, m.title || m.name || '');
          if (avail && avail.stream) {
            wildcardsDeck.push({...m, availability: avail});
          }
        }
        tries++;
      }
      if(wildcardsDeck.length === 0) {
        cont.innerHTML = `<div class="text-lg font-bold text-yellow-400">Sorry, nothing found for your region and settings!</div>
        <button class="wildcards-swipe-btn" id="wcTryAgainBtn" style="margin-top:2.5rem;">Try Again</button>`;
        document.getElementById('wcTryAgainBtn').onclick = ()=>startWildcardsGame();
        return;
      }
      renderWildcardsDeck();
    }

    // Overlay open/close control
    function closeWildcardsOverlay(){
      document.getElementById('wildcardsOverlay').style.display = 'none';
      document.body.style.overflow = '';
      wildcardsOverlayOpen = false;
      wildcardsDeck = [];
      wildcardsHand = [];
      wildcardsPhase = 'deck';
      wildcardsCurrent = 0;
      document.getElementById('wildcardsCelebration').innerHTML = '';
    }
    document.getElementById('wildcardsCloseBtn').onclick = closeWildcardsOverlay;

    // --- Existing DOMContentLoaded logic ---
    document.addEventListener('DOMContentLoaded', async () => {
      await runSearch(true);

      // Tabs
      document.getElementById('allTab').onclick = async function () {
        if (currentType !== 'all') {
          setActiveTab(this);
          currentType = 'all';
          await runSearch(true);
        }
      };
      document.getElementById('movieTab').onclick = async function () {
        if (currentType !== 'movie') {
          setActiveTab(this);
          currentType = 'movie';
          await runSearch(true);
        }
      };
      document.getElementById('tvTab').onclick = async function () {
        if (currentType !== 'tv') {
          setActiveTab(this);
          currentType = 'tv';
          await runSearch(true);
        }
      };
      document.getElementById('regionUK').onclick = async function () {
        if (currentRegion !== 'GB') {
          setRegionButton(this);
          currentRegion = 'GB';
          await runSearch(true);
        }
      };
      document.getElementById('regionUS').onclick = async function () {
        if (currentRegion !== 'US') {
          setRegionButton(this);
          currentRegion = 'US';
          await runSearch(true);
        }
      };
      document.getElementById('regionCA').onclick = async function () {
        if (currentRegion !== 'CA') {
          setRegionButton(this);
          currentRegion = 'CA';
          await runSearch(true);
        }
      };
      document.getElementById('searchInput').addEventListener('input', async function (e) {
        currentQuery = e.target.value;
        await runSearch(true);
      });
      document.getElementById('showMoreBtn').onclick = async function () {
        await showMore();
      };

      // Wild Cards (replace wildCard logic)
      document.getElementById('wildBtn').onclick = async function () {
        if(wildcardsOverlayOpen) return;
        await startWildcardsGame();
      };
    });
  </script>
</body>
</html>
