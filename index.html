<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-PQB3CSDG');</script>
  <!-- End Google Tag Manager -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-Z4PWK187GP"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-Z4PWK187GP');
  </script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Streamline</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <style>
    body {
      background: linear-gradient(to bottom, #1b103f, #090d28);
    }
    .tab-button {
      @apply px-4 py-2 rounded-t-lg font-semibold focus:outline-none shadow-md transition-colors duration-300;
    }
    .active-tab {
      @apply bg-gradient-to-r from-purple-600 via-blue-600 to-indigo-600 text-white;
    }
    .inactive-tab {
      @apply bg-gray-700 text-gray-300 hover:bg-gray-600;
    }
  </style>
</head>
<body class="text-white">
  <section class="text-center py-20 px-6">
    <h1 class="text-6xl font-bold mb-4 bg-gradient-to-r from-purple-500 via-pink-500 to-red-500 bg-clip-text text-transparent">Streamline</h1>
    <p class="text-xl text-gray-300 mb-6">Smarter streaming, simplified.</p>
    <div class="mb-4 flex justify-center space-x-2">
      <button id="allTab" class="tab-button active-tab">All</button>
      <button id="movieTab" class="tab-button inactive-tab">Movies</button>
      <button id="tvTab" class="tab-button inactive-tab">Series</button>
    </div>
    <input id="searchInput" type="text" placeholder="Search for a movie or series..." class="text-black w-full max-w-md px-4 py-2 rounded mb-8" />
    <div id="searchResults" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4"></div>
    <button id="showMoreBtn" class="mt-6 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-6 rounded">Show More</button>
  </section>
  <img src="https://em-content.zobj.net/source/microsoft-teams/337/octopus_1f419.png" alt="Octopus" class="fixed top-4 right-4 h-16 w-16 z-50">
  <footer class="text-center p-4 text-gray-400">
    This site uses the TMDb and Watchmode APIs but is not endorsed or certified by either.
  </footer>
  <script defer>
    // existing script...

      const searchInput = document.getElementById('searchInput');
      const searchHandler = async () => {
        const query = searchInput.value.trim().toLowerCase();
        const container = document.getElementById('searchResults');
        container.innerHTML = '';
        fullResults = [];
        displayedCount = 0;
        currentPage = 1;

        if (query === '') {
          isSearchMode = false;
          await fetchPopular();
        } else {
          isSearchMode = true;
          currentQuery = query;
          await searchTMDB(query);
          const normalize = (t) => t.toLowerCase().replace(/^the\s+/i, '');
          const queryNorm = normalize(query);
          const seenTitles = new Set();

          fullResults = fullResults.filter(item => {
            const title = (item.title || item.name || '').toLowerCase();
            const mediaType = item.media_type;
            if (mediaTypeFilter !== 'all' && mediaType !== mediaTypeFilter) return false;
            if (seenTitles.has(title)) return false;
            seenTitles.add(title);
            return true;
          }).sort((a, b) => {
            const aTitle = normalize(a.title || a.name || '');
            const bTitle = normalize(b.title || b.name || '');
            if (aTitle === queryNorm) return -1;
            if (bTitle === queryNorm) return 1;
            return (b.popularity || 0) - (a.popularity || 0);
          });
        }
        showMore();
      };

      searchInput.addEventListener('input', searchHandler);

      document.getElementById('allTab').addEventListener('click', async () => {
        mediaTypeFilter = 'all';
        setActiveTab(document.getElementById('allTab'));
        await searchHandler();
      });
      document.getElementById('movieTab').addEventListener('click', async () => {
        mediaTypeFilter = 'movie';
        setActiveTab(document.getElementById('movieTab'));
        await searchHandler();
      });
      document.getElementById('tvTab').addEventListener('click', async () => {
        mediaTypeFilter = 'tv';
        setActiveTab(document.getElementById('tvTab'));
        await searchHandler();
      });

    // rest of script remains unchanged...
  </script>
</body>
</html>


